<!-- scan_attendance.html -->

<!DOCTYPE html>
<html>
<head>
    <title>Scan Attendance</title>
</head>
<body>
    <h1>Scan Student ID</h1>
    <form id="attendance-form">
        <label for="student-id">Enter Student ID:</label>
        <input type="text" id="student-id" name="student_id" required>
        <button type="submit">Submit</button>
    </form>

    <div id="result">
        <p id="student-name"></p>
        <p id="tardy-status"></p>
    </div>

    <div id="current-time">
        Current Time: <span id="current-time-value"></span>
        Current Class Period: <span id="current-period-value"></span>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('attendance-form');
            const resultDiv = document.getElementById('result');
            const studentName = document.getElementById('student-name');
            const tardyStatus = document.getElementById('tardy-status');
            const currentTime = document.getElementById('current-time-value');
            const currentPeriod = document.getElementById('current-period-value');

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const studentId = document.getElementById('student-id').value;
                fetch('/scan_attendance/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'X-CSRFToken': '{{ csrf_token }}',  // Add the CSRF token
                    },
                    body: `student_id=${studentId}`,
                })
                .then(response => response.json())
                .then(data => {
                    studentName.textContent = `Student: ${data.student_name}`;
                    tardyStatus.textContent = `Tardy Status: ${data.tardy_status}`;
                });
            });

            // Update current time and class period periodically
            function updateCurrentTimeAndPeriod() {
                // Implement logic to fetch current time and class period from the server
                const currentTimeValue = '12:30 PM';  // Replace with actual time
                const currentPeriodValue = 'Period 3';  // Replace with actual period
                currentTime.textContent = currentTimeValue;
                currentPeriod.textContent = currentPeriodValue;
            }
            setInterval(updateCurrentTimeAndPeriod, 1000);  // Update every second
        });
    </script>
</body>
</html>
